#!/bin/bash
# save funcion
function save {
  echo "Saving..."
  echo "${value}" > ${devfile}
}
trap save EXIT
# get the current device name
devices=(`fastboot devices`);
device=${devices[0]}
echo "Current device: $device"
# Naming the persistent file:
devfile="./${device}.dat"
# if we don't have a file, start at 1000000000000000
if [ ! -f $devfile ] ; then
	value=1000000000000000
# otherwise read the value from the file
else
	value=`cat ${devfile}`
fi
while true
do
	# show it to the user
	output=$(fastboot oem unlock ${value})
	status=($output)
	echo -ne "Trying key ${value}"\\r
	# increment the value
	value=$((value+1));
	# and save it for nevaluet time
	# echo "${value}" > /tmp/value.dat
done;
